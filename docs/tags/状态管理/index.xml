<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>状态管理 on Saiga</title>
    <link>http://localhost:1313/tags/%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/</link>
    <description>Recent content in 状态管理 on Saiga</description>
    <generator>Hugo</generator>
    <language>zh-cn</language>
    <managingEditor>wuwenzen@outlook.com (wuwj)</managingEditor>
    <webMaster>wuwenzen@outlook.com (wuwj)</webMaster>
    <lastBuildDate>Sat, 20 Sep 2025 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/tags/%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>复杂业务系统前端的通用设计模式</title>
      <link>http://localhost:1313/posts/2025-09-20-complex-system-frontend-patterns/</link>
      <pubDate>Sat, 20 Sep 2025 00:00:00 +0000</pubDate><author>wuwenzen@outlook.com (wuwj)</author>
      <guid>http://localhost:1313/posts/2025-09-20-complex-system-frontend-patterns/</guid>
      <description>&lt;h2 id=&#34;背景&#34;&gt;背景&lt;/h2&gt;&#xA;&lt;p&gt;复杂业务系统的前端常见特征：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;页面多、模块多、角色多&lt;/li&gt;&#xA;&lt;li&gt;流程长、状态复杂、联动规则多&lt;/li&gt;&#xA;&lt;li&gt;需求迭代频繁，历史包袱逐步累积&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;这类系统的前端设计，核心目标是：&lt;strong&gt;用结构化手段降低不确定性&lt;/strong&gt;。下面总结一组可迁移的通用模式。&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;h2 id=&#34;模式-1流程驱动页面结构flow-driven-ui&#34;&gt;模式 1：流程驱动页面结构（Flow-Driven UI）&lt;/h2&gt;&#xA;&lt;p&gt;当页面属于“多步骤流程”时，建议将流程当成第一等公民：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;流程配置（步骤定义、进入条件、完成条件）&lt;/li&gt;&#xA;&lt;li&gt;步骤模块（每步独立校验与提交）&lt;/li&gt;&#xA;&lt;li&gt;流程控制器（负责跳转、恢复、草稿、回退）&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;结构示意：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-txt&#34; data-lang=&#34;txt&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;flow/&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  config.ts&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  controller.ts&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  steps/&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    stepA.tsx&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    stepB.tsx&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;收益：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;步骤增删更可控&lt;/li&gt;&#xA;&lt;li&gt;单步问题定位更快&lt;/li&gt;&#xA;&lt;li&gt;流程可复用（不同业务只换配置/步骤）&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;hr&gt;&#xA;&lt;h2 id=&#34;模式-2状态集中--边界清晰state-boundary&#34;&gt;模式 2：状态集中 + 边界清晰（State Boundary）&lt;/h2&gt;&#xA;&lt;p&gt;状态混乱通常来自“该共享的不共享、不该共享的全局化”。&lt;/p&gt;&#xA;&lt;p&gt;建议将状态分层：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;全局：会话、权限、字典、全局配置&lt;/li&gt;&#xA;&lt;li&gt;模块：业务模块内共享状态（列表筛选、分页、缓存）&lt;/li&gt;&#xA;&lt;li&gt;页面：页面局部状态（输入、展开、临时选中）&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;并明确“谁拥有数据的真相”（Single Source of Truth），减少多处重复维护。&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;h2 id=&#34;模式-3规则外置rules-as-data&#34;&gt;模式 3：规则外置（Rules as Data）&lt;/h2&gt;&#xA;&lt;p&gt;复杂系统最怕“规则散落在 UI 代码里”。推荐将规则外置成数据：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;条件必填&lt;/li&gt;&#xA;&lt;li&gt;展示/隐藏&lt;/li&gt;&#xA;&lt;li&gt;权限控制&lt;/li&gt;&#xA;&lt;li&gt;校验提示&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;示例（伪代码）：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;field&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;address&amp;#34;&lt;/span&gt;,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;requiredWhen&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;deliveryMode == &amp;#39;mail&amp;#39;&amp;#34;&lt;/span&gt;,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;message&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;选择邮寄后需要填写收件地址&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;收益：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;规则可审查（code review 更容易）&lt;/li&gt;&#xA;&lt;li&gt;规则可复用（多页面共享）&lt;/li&gt;&#xA;&lt;li&gt;UI 更干净（减少 if/else 地狱）&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;hr&gt;&#xA;&lt;h2 id=&#34;模式-4公共能力组件化capability-components&#34;&gt;模式 4：公共能力组件化（Capability Components）&lt;/h2&gt;&#xA;&lt;p&gt;复杂系统中常见的“公共能力”包括：&lt;/p&gt;</description>
    </item>
    <item>
      <title>金融业务系统中的表单与流程设计实践</title>
      <link>http://localhost:1313/posts/2025-04-10-financial-form-and-process-design/</link>
      <pubDate>Thu, 10 Apr 2025 00:00:00 +0000</pubDate><author>wuwenzen@outlook.com (wuwj)</author>
      <guid>http://localhost:1313/posts/2025-04-10-financial-form-and-process-design/</guid>
      <description>&lt;h2 id=&#34;背景&#34;&gt;背景&lt;/h2&gt;&#xA;&lt;p&gt;金融业务系统常见的页面形态是“表单 + 流程”组合：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;字段密度高（基础信息、声明项、选择项、上传项）&lt;/li&gt;&#xA;&lt;li&gt;校验复杂（联动校验、条件必填、格式校验）&lt;/li&gt;&#xA;&lt;li&gt;流程严格（多步骤、可回退、需留痕）&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;如果设计与实现不当，会出现：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;填写成本高、错误率高&lt;/li&gt;&#xA;&lt;li&gt;频繁中断后难以恢复&lt;/li&gt;&#xA;&lt;li&gt;需求迭代带来大量返工&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;本文总结一套偏工程视角、可复用的表单与流程实践方法。&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;h2 id=&#34;1-信息结构先把业务阶段拆清楚&#34;&gt;1. 信息结构：先把“业务阶段”拆清楚&lt;/h2&gt;&#xA;&lt;p&gt;长表单往往不是“字段太多”，而是“阶段混在一起”。推荐按阶段拆分：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;基本信息（身份、联系、所属信息）&lt;/li&gt;&#xA;&lt;li&gt;规则声明（勾选确认、阅读提示）&lt;/li&gt;&#xA;&lt;li&gt;证明材料（上传、有效期、补充说明）&lt;/li&gt;&#xA;&lt;li&gt;结果确认（回显、确认提交）&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;拆分标准：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;每一步只解决一类问题&lt;/li&gt;&#xA;&lt;li&gt;每一步的“完成条件”可清晰定义&lt;/li&gt;&#xA;&lt;li&gt;shows/hides 的动态联动尽量在步骤内完成&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;hr&gt;&#xA;&lt;h2 id=&#34;2-多步骤流程用状态机思维做可恢复&#34;&gt;2. 多步骤流程：用状态机思维做“可恢复”&lt;/h2&gt;&#xA;&lt;p&gt;对流程页面，最核心的能力是：&lt;strong&gt;中断后可恢复&lt;/strong&gt;。&lt;/p&gt;&#xA;&lt;h3 id=&#34;推荐的最小状态模型&#34;&gt;推荐的最小状态模型&lt;/h3&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-ts&#34; data-lang=&#34;ts&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;type&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;FlowState&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;step&lt;/span&gt;: &lt;span style=&#34;color:#66d9ef&#34;&gt;number&lt;/span&gt;;               &lt;span style=&#34;color:#75715e&#34;&gt;// 当前步骤&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;completedSteps&lt;/span&gt;: &lt;span style=&#34;color:#66d9ef&#34;&gt;number&lt;/span&gt;[];   &lt;span style=&#34;color:#75715e&#34;&gt;// 已完成步骤&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;draft&lt;/span&gt;: &lt;span style=&#34;color:#66d9ef&#34;&gt;Record&lt;/span&gt;&amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;string&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;any&lt;/span&gt;&amp;gt;; &lt;span style=&#34;color:#75715e&#34;&gt;// 草稿数据&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;lastSavedAt?&lt;/span&gt;: &lt;span style=&#34;color:#66d9ef&#34;&gt;number&lt;/span&gt;;       &lt;span style=&#34;color:#75715e&#34;&gt;// 最近保存时间&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;保存策略&#34;&gt;保存策略&lt;/h3&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;本地草稿（localStorage/IndexedDB）：快速、无需网络&lt;/li&gt;&#xA;&lt;li&gt;服务端草稿（可选）：换设备继续、可做留痕&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;建议组合使用：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;输入时本地节流保存（例如 1–2 秒）&lt;/li&gt;&#xA;&lt;li&gt;步骤完成/离开页面时触发服务端保存（可选）&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;hr&gt;&#xA;&lt;h2 id=&#34;3-校验策略把校验当成一个独立系统&#34;&gt;3. 校验策略：把“校验”当成一个独立系统&lt;/h2&gt;&#xA;&lt;p&gt;常见错误是：校验逻辑散落在各个组件里，最终变成难以维护的条件判断。&lt;/p&gt;&#xA;&lt;p&gt;推荐做法是：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;校验规则集中管理（按字段或按步骤）&lt;/li&gt;&#xA;&lt;li&gt;UI 只负责展示校验结果&lt;/li&gt;&#xA;&lt;li&gt;支持三种校验时机&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 id=&#34;三种校验时机&#34;&gt;三种校验时机&lt;/h3&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;即时校验&lt;/strong&gt;：输入完成后触发（格式类最适合）&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;离焦校验&lt;/strong&gt;：失焦触发（减少打断）&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;提交校验&lt;/strong&gt;：步骤提交时触发（联动/条件必填）&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;示例（伪代码）：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-ts&#34; data-lang=&#34;ts&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;rules&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;phone&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; [&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    { &lt;span style=&#34;color:#a6e22e&#34;&gt;when&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;blur&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;test&lt;/span&gt;: &lt;span style=&#34;color:#66d9ef&#34;&gt;isPhone&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;message&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;手机号格式不正确&amp;#34;&lt;/span&gt; }&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  ],&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;address&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; [&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    { &lt;span style=&#34;color:#a6e22e&#34;&gt;when&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;submit&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;test&lt;/span&gt;: &lt;span style=&#34;color:#66d9ef&#34;&gt;required&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;message&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;联系地址不能为空&amp;#34;&lt;/span&gt; }&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  ]&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;&#xA;&lt;h2 id=&#34;4-动态联动让条件必填可解释&#34;&gt;4. 动态联动：让“条件必填”可解释&lt;/h2&gt;&#xA;&lt;p&gt;金融表单常见“条件必填”：&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
