<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>模版管理 on Saiga</title>
    <link>http://localhost:1313/tags/%E6%A8%A1%E7%89%88%E7%AE%A1%E7%90%86/</link>
    <description>Recent content in 模版管理 on Saiga</description>
    <generator>Hugo</generator>
    <language>zh-cn</language>
    <managingEditor>wuwenzen@outlook.com (wuwj)</managingEditor>
    <webMaster>wuwenzen@outlook.com (wuwj)</webMaster>
    <lastBuildDate>Fri, 01 Apr 2022 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/tags/%E6%A8%A1%E7%89%88%E7%AE%A1%E7%90%86/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>电子合同前端架构：模版、签章与签署流程</title>
      <link>http://localhost:1313/posts/2022-04-01-e-contract-frontend-architecture/</link>
      <pubDate>Fri, 01 Apr 2022 00:00:00 +0000</pubDate><author>wuwenzen@outlook.com (wuwj)</author>
      <guid>http://localhost:1313/posts/2022-04-01-e-contract-frontend-architecture/</guid>
      <description>&lt;p&gt;做电子合同相关的前端，会很快感觉到：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;这已经不只是「展示一个 PDF」；&lt;/li&gt;&#xA;&lt;li&gt;还牵扯到模版配置、变量渲染、签章交互、签署流程编排、证据留存等。&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;如果一股脑儿堆在一个项目里，很快就会失控。&lt;br&gt;&#xA;这篇文章试着从前端视角，把电子合同拆成几个独立模块，聊聊一套比较清晰的架构思路。&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;h2 id=&#34;1-电子合同前端要解决什么&#34;&gt;1. 电子合同前端要解决什么？&lt;/h2&gt;&#xA;&lt;p&gt;从用户视角看，大概是：&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;看到合同预览（包含自己信息）；&lt;/li&gt;&#xA;&lt;li&gt;在指定位置签名/盖章/确认；&lt;/li&gt;&#xA;&lt;li&gt;提交后能下载已签署版本，必要时可验证真伪。&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;从前端视角再拆细一点：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;模版管理&lt;/strong&gt;：合同模版如何配置 &amp;amp; 渲染；&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;变量填充&lt;/strong&gt;：客户姓名、证件号、金额等动态内容；&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;渲染方式&lt;/strong&gt;：HTML 还是 PDF 预览，是否支持高缩放；&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;签章交互&lt;/strong&gt;：点击签署区域、手写签名/用预制印章；&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;流程编排&lt;/strong&gt;：签署顺序、多人会签/联签；&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;留痕 &amp;amp; 防篡改&lt;/strong&gt;：前端如何配合后端做证据链。&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;这些职责千万别写在一个「超级组件」里。&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;h2 id=&#34;2-模块切分四层结构&#34;&gt;2. 模块切分：四层结构&lt;/h2&gt;&#xA;&lt;p&gt;我们落地时，大致划成四层：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;业务流程层  ←  电子合同服务层  ←  渲染 &amp;amp; 交互层  ←  基础组件 &amp;amp; 工具层&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;21-业务流程层具体业务系统&#34;&gt;2.1 业务流程层（具体业务系统）&lt;/h3&gt;&#xA;&lt;p&gt;例如：开户流程、理财签约、风险揭示等业务系统：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;只关心「在流程某一环节触发合同签署」；&lt;/li&gt;&#xA;&lt;li&gt;不直接操心合同模版、签章细节；&lt;/li&gt;&#xA;&lt;li&gt;与电子合同前端交互的接口尽量保持简单。&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 id=&#34;22-电子合同服务层前端-sdk&#34;&gt;2.2 电子合同服务层（前端 SDK）&lt;/h3&gt;&#xA;&lt;p&gt;可以理解成一个前端 SDK：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;提供统一方法：&lt;code&gt;createContract&lt;/code&gt;, &lt;code&gt;previewContract&lt;/code&gt;, &lt;code&gt;signContract&lt;/code&gt;；&lt;/li&gt;&#xA;&lt;li&gt;内部负责：请求合同服务接口、拿到模版、变量、签署状态等；&lt;/li&gt;&#xA;&lt;li&gt;把渲染和交互细节屏蔽在内部。&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;示例：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-ts&#34; data-lang=&#34;ts&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;import&lt;/span&gt; { &lt;span style=&#34;color:#a6e22e&#34;&gt;openContractSignDialog&lt;/span&gt; } &lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;@ecm/sdk&amp;#39;&lt;/span&gt;;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;openContractSignDialog&lt;/span&gt;({&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;bizType&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;OPEN_ACCOUNT&amp;#39;&lt;/span&gt;,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;bizId&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;xxx&amp;#39;&lt;/span&gt;,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;viewer&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;customer&amp;#39;&lt;/span&gt;,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;});&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;23-渲染--交互层&#34;&gt;2.3 渲染 &amp;amp; 交互层&lt;/h3&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;负责把合同模版 + 变量渲染成可阅读界面；&lt;/li&gt;&#xA;&lt;li&gt;在指定签署域上挂载交互（点击弹签名板等）；&lt;/li&gt;&#xA;&lt;li&gt;处理缩放、翻页、跳转签署域等体验细节。&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 id=&#34;24-基础组件--工具层&#34;&gt;2.4 基础组件 &amp;amp; 工具层&lt;/h3&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;PDF/HTML 渲染组件；&lt;/li&gt;&#xA;&lt;li&gt;手写签名板组件；&lt;/li&gt;&#xA;&lt;li&gt;坐标转换、缩放计算工具；&lt;/li&gt;&#xA;&lt;li&gt;与后端约定的签署域结构解析等。&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;hr&gt;&#xA;&lt;h2 id=&#34;3-合同模版与变量渲染&#34;&gt;3. 合同模版与变量渲染&lt;/h2&gt;&#xA;&lt;h3 id=&#34;31-模版形式&#34;&gt;3.1 模版形式&lt;/h3&gt;&#xA;&lt;p&gt;常见两种：&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
