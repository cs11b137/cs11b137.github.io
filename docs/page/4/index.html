<!DOCTYPE html>
<html lang="zh-cn">
    <head>
	<meta name="generator" content="Hugo 0.152.2"><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Saiga</title><meta name="Description" content="This is my cool site"><meta property="og:url" content="http://localhost:1313/">
  <meta property="og:site_name" content="Saiga">
  <meta property="og:title" content="Saiga">
  <meta property="og:description" content="This is my cool site">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="website">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Saiga">
  <meta name="twitter:description" content="This is my cool site">
      <meta name="twitter:site" content="@https://github.com/cs11b137">
<meta name="application-name" content="Saiga">
<meta name="apple-mobile-web-app-title" content="Saiga"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/logo.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://localhost:1313/" /><link rel="alternate" href="/index.xml" type="application/rss+xml" title="Saiga">
    <link rel="feed" href="/index.xml" type="application/rss+xml" title="Saiga"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "WebSite",
        "url": "http:\/\/localhost:1313\/","inLanguage": "zh-cn","author": {
                "@type": "Person",
                "name": "wuwj"
            },"description": "This is my cool site","name": "Saiga"
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Saiga">Saiga</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/about/"> About </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Saiga">Saiga</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/about/" title="">About</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="page home" data-home="posts"><div class="home-profile"><div class="home-avatar"><a href="/posts/" title="Posts"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./avatar.jpg"
        data-srcset="./avatar.jpg, ./avatar.jpg 1.5x, ./avatar.jpg 2x"
        data-sizes="auto"
        alt="./avatar.jpg"
        title="./avatar.jpg" /></a></div><div class="home-subtitle"><div id="id-1" class="typeit"></div></div><div class="links"><a href="https://github.com/https://github.com/cs11b137" title="GitHub" target="_blank" rel="noopener noreffer me"><i class="fab fa-github fa-fw" aria-hidden="true"></i></a><a href="https://facebook.com/https://github.com/cs11b137" title="facebook" target="_blank" rel="noopener noreffer me"><i class="fab fa-facebook fa-fw" aria-hidden="true"></i></a><a href="mailto:https://github.com/cs11b137" title="Email" rel="me"><i class="far fa-envelope fa-fw" aria-hidden="true"></i></a><a href="https://github.com/cs11b137" target="_blank" rel="noopener noreffer me"></a><a href="https://linkedin.com/in/https://github.com/cs11b137" title="LinkedIn" target="_blank" rel="noopener noreffer me"><i class="fab fa-linkedin fa-fw" aria-hidden="true"></i></a><a href="https://twitter.com/https://github.com/cs11b137" title="Twitter" target="_blank" rel="noopener noreffer me"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="https://www.instagram.com/https://github.com/cs11b137" title="Instagram" target="_blank" rel="noopener noreffer me"><i class="fab fa-instagram fa-fw" aria-hidden="true"></i></a><a href="https://t.me/https://github.com/cs11b137" title="Telegram" target="_blank" rel="noopener noreffer me"><i class="fab fa-telegram-plane fa-fw" aria-hidden="true"></i></a><a href="https://www.youtube.com/user/https://github.com/cs11b137" title="YouTube" target="_blank" rel="noopener noreffer me"><i class="fab fa-youtube fa-fw" aria-hidden="true"></i></a><a href="/index.xml" title="RSS" target="_blank" rel="noopener noreffer me"><i class="fas fa-rss fa-fw" aria-hidden="true"></i></a></div></div>
<article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/posts/2023-07-22-ai-assistant-for-dev/">给自己搭一个「AI 助理」开发流程</a>
    </h1><div class="post-meta"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>wuwj</a></span>&nbsp;<span class="post-publish">发布于 <time datetime="2023-07-22">2023-07-22</time></span>&nbsp;<span class="post-category">收录于 <a href="/categories/ai-%E4%B8%8E%E5%BC%80%E5%8F%91%E8%80%85%E4%BD%93%E9%AA%8C/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>AI 与开发者体验</a></span></div><div class="content"><p>2023 年对我来说有一个明显变化：</p>
<blockquote>
<p>编辑器不再是一个「孤立工具」，而是被各种 AI 助手包围。</p>
</blockquote>
<p>从简单的代码补全，到用大模型参与需求理解、方案推演、重构、写单测……<br>
这篇文章就讲讲我是怎么给自己搭一套「AI 助理」开发流程的。</p>
<hr>
<h2 id="1-先想清楚希望-ai-在开发中帮我做什么">1. 先想清楚：希望 AI 在开发中帮我做什么？</h2>
<p>我给自己列了一个清单：</p>
<ol>
<li><strong>样板代码生成</strong>：页面骨架、接口封装、组件模板；</li>
<li><strong>复杂逻辑解释/重构</strong>：老代码梳理、新方案对比；</li>
<li><strong>单测生成</strong>：尤其是工具函数、纯逻辑模块；</li>
<li><strong>文档和注释</strong>：根据代码生成合适的注释、接口说明；</li>
<li><strong>代码 Review 辅助</strong>：帮我发现一些潜在问题或改进点。</li>
</ol>
<p>工具上则主要依赖：</p>
<ul>
<li>编辑器内的代码补全（Copilot 类）；</li>
<li>Chat 类大模型（ChatGPT 等）；</li>
<li>自己整理的一些 Prompt 模板。</li>
</ul>
<hr>
<h2 id="2-prompt-模板把怎么问提前想好">2. Prompt 模板：把「怎么问」提前想好</h2>
<p>很快会发现：随便问一句「帮我优化这段代码」效果参差不齐。<br>
于是我开始为不同场景整理<strong>固定 Prompt 模板</strong>。</p>
<h3 id="21-重构模板">2.1 重构模板</h3>
<blockquote>
<p>请作为资深前端工程师，帮我重构下面这段代码：</p>
<ol>
<li>目标是提高可读性和可维护性，而不是追求最短写法；</li>
<li>如果有明显的边界情况，请指出并补上处理；</li>
<li>给出重构后的代码，并用要点列出你做了哪些调整和原因。</li>
</ol>
<p>代码如下：<br>
```ts<br>
// code here<br>
```</p>
</blockquote>
<h3 id="22-单测生成模板">2.2 单测生成模板</h3>
<blockquote>
<p>帮我为下面这个纯函数生成单元测试用例：</p>
<ol>
<li>使用 Jest 语法；</li>
<li>覆盖常见正常输入和几种边界情况；</li>
<li>简要说明每个测试用例要验证的点。</li>
</ol>
<p>代码如下：<br>
```ts<br>
// code here<br>
```</p>
</blockquote>
<p>我会把这些模板存成 Snippet 或者存在笔记里，方便复用。</p>
<hr>
<h2 id="3-编辑器内的-ai使用边界和习惯">3. 编辑器内的 AI：使用边界和习惯</h2>
<p>装上 Copilot 类插件之后，一开始很容易「啥都接」。<br>
用了一段时间，我给自己定了几个使用习惯：</p></div><div class="post-footer">
        <a href="/posts/2023-07-22-ai-assistant-for-dev/">阅读全文</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B/">开发流程</a>,&nbsp;<a href="/tags/ai-%E5%8A%A9%E6%89%8B/">AI 助手</a>,&nbsp;<a href="/tags/prompt-%E6%A8%A1%E6%9D%BF/">Prompt 模板</a>,&nbsp;<a href="/tags/%E6%B5%8B%E8%AF%95%E4%B8%8E-lint/">测试与 Lint</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/posts/2023-06-05-ai-api-best-practices/">调用大模型 API 的几个最佳实践：重试、降级与审计</a>
    </h1><div class="post-meta"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>wuwj</a></span>&nbsp;<span class="post-publish">发布于 <time datetime="2023-06-05">2023-06-05</time></span>&nbsp;<span class="post-category">收录于 <a href="/categories/ai-%E5%BA%94%E7%94%A8/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>AI 应用</a></span></div><div class="content"><p>刚开始用大模型 API 时，大家一般关心的是：</p>
<blockquote>
<p>这个模型效果好不好？回答聪不聪明？</p>
</blockquote>
<p>但当你真的把它作为「线上能力」接入产品时，会发现很多工程问题：</p>
<ul>
<li>API 偶尔超时 / 报错怎么办？</li>
<li>费用怎么控？</li>
<li>返回内容里如果有敏感信息怎么办？</li>
<li>出了问题，怎么排查某次请求？</li>
</ul>
<p>这篇文章就是从这些「落地问题」出发，整理几条接入大模型 API 的最佳实践。</p>
<hr>
<h2 id="1-超时与重试别把前端一直挂着">1. 超时与重试：别把前端一直挂着</h2>
<h3 id="11-超时要有明确上限">1.1 超时要有明确上限</h3>
<p>大模型生成本身需要时间，如果不设超时，前端可能会一直转圈。<br>
我们一般做法：</p>
<ul>
<li>在 BFF / 中间层对每个调用设定超时时间（例如 10–15 秒）；</li>
<li>超时后直接返回「超时错误」，由前端给出友好提示；</li>
<li>前端也设置请求超时，避免被挂死。</li>
</ul>
<h3 id="12-重试策略">1.2 重试策略</h3>
<p>常见错误类型：</p>
<ul>
<li>临时网络抖动；</li>
<li>API 限流（429）；</li>
<li>服务端偶发异常。</li>
</ul>
<p>对<strong>幂等请求</strong>（比如生成建议文案），我们采用：</p>
<ul>
<li><strong>指数退避重试</strong>：例如最多重试 2 次，间隔 500ms / 1000ms；</li>
<li>遇到某些错误码（如 4xx 中的参数错误）不重试。</li>
</ul>
<p>伪代码：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">callLLMWithRetry</span>(<span style="color:#a6e22e">payload</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">maxRetry</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">attempt</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">true</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">callLLM</span>(<span style="color:#a6e22e">payload</span>);
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">e</span>: <span style="color:#66d9ef">any</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">isRetryableError</span>(<span style="color:#a6e22e">e</span>) <span style="color:#f92672">||</span> <span style="color:#a6e22e">attempt</span> <span style="color:#f92672">&gt;=</span> <span style="color:#a6e22e">maxRetry</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">throw</span> <span style="color:#a6e22e">e</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">attempt</span><span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">sleep</span>(<span style="color:#ae81ff">500</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">attempt</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h2 id="2-降级模型不可用时要有备胎">2. 降级：模型不可用时要有「备胎」</h2>
<p>大模型 API 作为外部依赖，不可能 100% 可用。<br>
因此建议设计「降级方案」：</p></div><div class="post-footer">
        <a href="/posts/2023-06-05-ai-api-best-practices/">阅读全文</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/%E5%A4%A7%E6%A8%A1%E5%9E%8B-api/">大模型 API</a>,&nbsp;<a href="/tags/%E5%AE%B9%E9%94%99/">容错</a>,&nbsp;<a href="/tags/%E9%87%8D%E8%AF%95/">重试</a>,&nbsp;<a href="/tags/%E5%AE%A1%E8%AE%A1/">审计</a>,&nbsp;<a href="/tags/%E5%AE%89%E5%85%A8/">安全</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/posts/2023-04-20-ab-testing-in-frontend/">前端视角下的 A/B Test：埋点、分流与验证</a>
    </h1><div class="post-meta"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>wuwj</a></span>&nbsp;<span class="post-publish">发布于 <time datetime="2023-04-20">2023-04-20</time></span>&nbsp;<span class="post-category">收录于 <a href="/categories/%E5%AE%9E%E9%AA%8C%E4%B8%8E%E5%A2%9E%E9%95%BF/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>实验与增长</a></span></div><div class="content"><p>「做个 A/B 实验看看」这句话听起来很轻松，真正落地时会发现：</p>
<ul>
<li>指标怎么算？</li>
<li>实验人群怎么分？</li>
<li>前端要怎么接入实验配置？</li>
<li>实验结束之后，代码怎么收口？</li>
</ul>
<p>这篇文章从前端的角度，讲一次相对完整的 A/B 实验闭环。</p>
<hr>
<h2 id="1-先确定为什么要做这个实验">1. 先确定：为什么要做这个实验？</h2>
<p>我们当时的实验目标是：<strong>提高某投资流程的转化率</strong>。</p>
<p>假设是：</p>
<blockquote>
<p>把原本一个超长的单页表单拆成多步引导，是否能提高「填写完成率」。</p>
</blockquote>
<p>因此：</p>
<ul>
<li>实验对象：访问该流程的真实用户；</li>
<li>对照组：看到旧版「单页表单」；</li>
<li>实验组：看到新版「多步引导」；</li>
<li>观测指标：完成率、平均耗时、中途流失位置等。</li>
</ul>
<p>只有先把这些定义清楚，后续埋点和分流才有方向。</p>
<hr>
<h2 id="2-埋点设计先有指标再谈实现">2. 埋点设计：先有指标，再谈实现</h2>
<p>这次我们重点关心几个指标：</p>
<ol>
<li><code>flow_enter</code>：进入流程的人数；</li>
<li><code>flow_complete</code>：完成流程的人数；</li>
<li><code>step_view</code>：在多步表单中，每一步的曝光；</li>
<li><code>step_error</code>：每一步表单提交失败次数。</li>
</ol>
<p>在前端埋点上做了几件事：</p>
<ul>
<li>所有埋点带上 <code>experiment_id</code> 和 <code>variant</code>（A / B）；</li>
<li>关键事件使用统一的 <code>event_name</code> + <code>event_params</code> 格式；</li>
<li>尽量避免把业务逻辑硬编码到埋点名里。</li>
</ul>
<p>示例：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#a6e22e">track</span>(<span style="color:#e6db74">&#39;flow_enter&#39;</span>, {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">experimentId</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;exp_split_form_v1&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">variant</span>: <span style="color:#66d9ef">currentVariant</span>, <span style="color:#75715e">// &#39;A&#39; 或 &#39;B&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">track</span>(<span style="color:#e6db74">&#39;step_view&#39;</span>, {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">experimentId</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;exp_split_form_v1&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">variant</span>: <span style="color:#66d9ef">currentVariant</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">step</span>: <span style="color:#66d9ef">1</span>,
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">track</span>(<span style="color:#e6db74">&#39;flow_complete&#39;</span>, {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">experimentId</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;exp_split_form_v1&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">variant</span>: <span style="color:#66d9ef">currentVariant</span>,
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><hr>
<h2 id="3-分流让实验公平且可控">3. 分流：让实验「公平」且可控</h2>
<h3 id="31-基本原则">3.1 基本原则</h3>
<ol>
<li>
<p><strong>同一用户体验稳定</strong></p>
<ul>
<li>被分到 A 组，就一直看 A；</li>
<li>避免一次访问是 A，刷新变 B。</li>
</ul>
</li>
<li>
<p><strong>分配近似均匀</strong></p></div><div class="post-footer">
        <a href="/posts/2023-04-20-ab-testing-in-frontend/">阅读全文</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/a/b-%E6%B5%8B%E8%AF%95/">A/B 测试</a>,&nbsp;<a href="/tags/%E5%9F%8B%E7%82%B9/">埋点</a>,&nbsp;<a href="/tags/%E5%88%86%E6%B5%81/">分流</a>,&nbsp;<a href="/tags/%E5%AE%9E%E9%AA%8C%E5%B9%B3%E5%8F%B0/">实验平台</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/posts/2023-03-02-micro-frontend-trial/">微前端尝试记：什么时候值得用，又该怎么用</a>
    </h1><div class="post-meta"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>wuwj</a></span>&nbsp;<span class="post-publish">发布于 <time datetime="2023-03-02">2023-03-02</time></span>&nbsp;<span class="post-category">收录于 <a href="/categories/%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>架构设计</a></span></div><div class="content"><p>微前端这个词已经火了很多年，但真要落地时，经常会遇到几个灵魂拷问：</p>
<ul>
<li>我们的项目有必要用吗？</li>
<li>是不是换个 iframe 也能解决？</li>
<li>上了之后会不会更复杂？</li>
</ul>
<p>这篇文章是一次真实的尝试记录：我们为什么考虑微前端、最后怎么落地、踩过哪些坑。</p>
<hr>
<h2 id="1-我们为什么会想到微前端">1. 我们为什么会想到微前端？</h2>
<p>当时的背景：</p>
<ul>
<li>已经有一个比较大的运营中台，使用 Vue2；</li>
<li>新业务线希望独立迭代，想用 Vue3/Vite；</li>
<li>不同团队节奏不一致，但最终还是要在一个「统一入口」下为业务方服务。</li>
</ul>
<p>简单说就是：</p>
<blockquote>
<p>不同团队、不同技术栈、不同发布节奏，但对外要看起来像「一个系统」。</p>
</blockquote>
<p>这是典型的微前端适用场景之一。</p>
<p>我们也认真讨论过：</p>
<ul>
<li>
<p><strong>方案 A：继续在原系统里加路由</strong></p>
<ul>
<li>所有业务都塞进一个 Vue2 大仓库；</li>
<li>优点是简单，缺点是历史包袱越来越重。</li>
</ul>
</li>
<li>
<p><strong>方案 B：子系统独立域名</strong></p>
<ul>
<li>完全分开，运营自己维护入口；</li>
<li>用户在不同系统间跳转，体验割裂。</li>
</ul>
</li>
</ul>
<p>最终，我们选了一个折中方案：</p>
<blockquote>
<p><strong>用微前端把多个独立应用挂在一个统一壳子下，保证用户体验一致，同时保留各团队的技术栈和发布节奏。</strong></p>
</blockquote>
<hr>
<h2 id="2-选型为什么最后选了框架型方案">2. 选型：为什么最后选了「框架型」方案</h2>
<p>有几种路线：</p>
<ol>
<li>自己基于 iframe + postMessage 搞一套协议；</li>
<li>使用成熟微前端框架（如 single-spa、qiankun、Module Federation 等）；</li>
<li>基于构建时集成的模块联邦方案（Webpack Module Federation 等）。</li>
</ol>
<p>我们最后选的是类似 qiankun 的「运行时加载子应用」方案，原因：</p>
<ul>
<li>接入成本相对低，不用大改原有项目；</li>
<li>不强绑某个构建工具；</li>
<li>社区实践比较多。</li>
</ul>
<p>整体架构是：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>主应用（Shell，负责导航/布局/统一登录）
</span></span><span style="display:flex;"><span>  ├── 子应用 A（Vue2，老中台）
</span></span><span style="display:flex;"><span>  ├── 子应用 B（Vue3，新模块）
</span></span><span style="display:flex;"><span>  └── 子应用 C（React，小实验项目）
</span></span></code></pre></div><hr>
<h2 id="3-路由接入谁管-url">3. 路由接入：谁管 URL？</h2>
<p>微前端绕不开的一个问题是：<strong>路由由谁控制？</strong></p></div><div class="post-footer">
        <a href="/posts/2023-03-02-micro-frontend-trial/">阅读全文</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/%E5%BE%AE%E5%89%8D%E7%AB%AF/">微前端</a>,&nbsp;<a href="/tags/%E8%B7%A8%E5%9B%A2%E9%98%9F/">跨团队</a>,&nbsp;<a href="/tags/%E5%89%8D%E7%AB%AF%E6%9E%B6%E6%9E%84/">前端架构</a>,&nbsp;<a href="/tags/%E5%AD%90%E5%BA%94%E7%94%A8%E9%80%9A%E4%BF%A1/">子应用通信</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/posts/2023-01-15-monorepo-migration/">把多个前端项目合进一个 Monorepo 是怎样的体验</a>
    </h1><div class="post-meta"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>wuwj</a></span>&nbsp;<span class="post-publish">发布于 <time datetime="2023-01-15">2023-01-15</time></span>&nbsp;<span class="post-category">收录于 <a href="/categories/%E5%B7%A5%E7%A8%8B%E5%8C%96/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>工程化</a></span></div><div class="content"><p>之前团队的前端项目是这样管理的：</p>
<ul>
<li>每个系统一个 Git 仓库；</li>
<li>各自有一套构建脚本、一份依赖清单；</li>
<li>公共组件、工具要么复制粘贴，要么用「半私有」的 NPM 包。</li>
</ul>
<p>结果就是：</p>
<ul>
<li>组件 bug 修一份，要手动同步 N 个仓库；</li>
<li>依赖升级经常有「版本错乱」；</li>
<li>CI 流水线一堆重复配置。</li>
</ul>
<p>于是我们决定把几个核心前端项目合到一个 Monorepo 里。<br>
这篇文章就是那次迁移的实战记录：<strong>工具选择、包划分、依赖管理、CI 改造，全流程。</strong></p>
<hr>
<h2 id="1-为什么要搞-monorepo">1. 为什么要搞 Monorepo？</h2>
<p>总结下来就是三点：</p>
<ol>
<li>
<p><strong>公共代码复用</strong></p>
<ul>
<li>组件库、Hooks、工具函数不用再复制粘贴；</li>
<li>bug 修一次，多项目同步升级。</li>
</ul>
</li>
<li>
<p><strong>一致的工程规范</strong></p>
<ul>
<li>统一 ESLint/Prettier/Commit 规范；</li>
<li>统一构建脚手架和发布流程。</li>
</ul>
</li>
<li>
<p><strong>协同开发体验好</strong></p>
<ul>
<li>打开一个仓库就能看到相关项目；</li>
<li>修改组件立刻能在多个应用里验证。</li>
</ul>
</li>
</ol>
<p>当然，Monorepo 不是银弹，仓库会变大、CI 要更精细。<br>
所以「是否值得」的标准是：</p>
<blockquote>
<p><strong>项目之间有明显共享，且会长期共同演进。</strong></p>
</blockquote>
<hr>
<h2 id="2-工具选型pnpm--turborepo">2. 工具选型：pnpm + Turborepo</h2>
<p>我们调研了一圈：Lerna、Nx、Yarn Workspaces、pnpm Workspace、Turborepo……<br>
最后选的是：<strong>pnpm Workspace + Turborepo</strong>，原因：</p>
<ul>
<li>pnpm：硬链接节省磁盘空间、依赖管理清晰、速度快；</li>
<li>Turborepo：任务编排 + 缓存好用，学习成本相对较低。</li>
</ul>
<h3 id="21-仓库结构">2.1 仓库结构</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>repo-root
</span></span><span style="display:flex;"><span>├── apps
</span></span><span style="display:flex;"><span>│   ├── manager-web        <span style="color:#75715e"># 管理端</span>
</span></span><span style="display:flex;"><span>│   ├── investor-web       <span style="color:#75715e"># 投资人 Web</span>
</span></span><span style="display:flex;"><span>│   └── mini-program       <span style="color:#75715e"># 小程序（uni-app 等）</span>
</span></span><span style="display:flex;"><span>├── packages
</span></span><span style="display:flex;"><span>│   ├── ui-components      <span style="color:#75715e"># 通用 UI 组件库</span>
</span></span><span style="display:flex;"><span>│   ├── shared-utils       <span style="color:#75715e"># 工具函数</span>
</span></span><span style="display:flex;"><span>│   └── eslint-config      <span style="color:#75715e"># 统一 ESLint 配置</span>
</span></span><span style="display:flex;"><span>├── package.json
</span></span><span style="display:flex;"><span>├── pnpm-workspace.yaml
</span></span><span style="display:flex;"><span>└── turbo.json
</span></span></code></pre></div><p><code>pnpm-workspace.yaml</code>：</p></div><div class="post-footer">
        <a href="/posts/2023-01-15-monorepo-migration/">阅读全文</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/monorepo/">Monorepo</a>,&nbsp;<a href="/tags/turborepo/">Turborepo</a>,&nbsp;<a href="/tags/pnpm/">Pnpm</a>,&nbsp;<a href="/tags/%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86/">依赖管理</a>,&nbsp;<a href="/tags/ci/cd/">CI/CD</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/posts/2022-12-18-ai-code-helper-experiment/">第一次用 AI 写前端代码：哪些好用，哪些坑</a>
    </h1><div class="post-meta"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>wuwj</a></span>&nbsp;<span class="post-publish">发布于 <time datetime="2022-12-18">2022-12-18</time></span>&nbsp;<span class="post-category">收录于 <a href="/categories/ai-%E6%8E%A2%E7%B4%A2/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>AI 探索</a></span></div><div class="content"><p>2022 年我开始把 AI 编码助手真正用在日常开发里，体验可以用一句话概括：</p>
<blockquote>
<p><strong>它不是银弹，但如果用得好，很像一个永远不喊累的实习生。</strong></p>
</blockquote>
<p>这篇文章主要记录几个方面：</p>
<ul>
<li>它在哪些场景明显好用；</li>
<li>哪些地方容易翻车；</li>
<li>我最后形成的一些使用习惯。</li>
</ul>
<hr>
<h2 id="1-几个惊艳到的使用场景">1. 几个「惊艳到」的使用场景</h2>
<h3 id="11-写样板代码boilerplate">1.1 写样板代码（boilerplate）</h3>
<p>比如：</p>
<ul>
<li>新建一个 Vue 3 组合式组件；</li>
<li>写一个标准的 Axios 封装；</li>
<li>初始化一个简单的 React 页面结构。</li>
</ul>
<p>以前要么复制项目里旧代码改，要么从 CLI 模板改；<br>
现在直接丢一句：</p>
<blockquote>
<p>「写一个 Vue3 + TypeScript 的表格组件，支持分页、排序，props 包含 xxx。」</p>
</blockquote>
<p>然后拿到一个 70% 可用的版本，再按自己习惯调整。</p>
<h3 id="12-写简单的工具函数">1.2 写简单的工具函数</h3>
<p>例如：</p>
<ul>
<li>将后端分页结果转换为前端表格数据；</li>
<li>格式化日期/金额；</li>
<li>从树结构中找到某个节点路径。</li>
</ul>
<p>用自然语言描述需求 + 给一两个例子，AI 通常能给出还不错的实现。<br>
有时候还能顺带推荐几种写法，帮你对比。</p>
<h3 id="13-帮忙翻译老代码">1.3 帮忙「翻译」老代码</h3>
<p>面对一些古早 jQuery/复杂 if-else 的老代码，直接让 AI：</p>
<blockquote>
<p>「帮我解释这段代码在干嘛，并用更现代的写法重构。」</p>
</blockquote>
<p>得到的是：</p>
<ul>
<li>一段自然语言解释（方便确认理解）；</li>
<li>一版初步的重构实现（不一定完美，但至少是个起点）。</li>
</ul>
<hr>
<h2 id="2-重构和单测ai-很适合当助手">2. 重构和单测：AI 很适合当助手</h2>
<h3 id="21-帮忙拆函数--命名">2.1 帮忙拆函数 / 命名</h3>
<p>长函数重构时，让 AI：</p>
<blockquote>
<p>「这段函数太长了，帮我按逻辑拆成几个小函数，顺带起一些更好的函数名。」</p></div><div class="post-footer">
        <a href="/posts/2022-12-18-ai-code-helper-experiment/">阅读全文</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/ai-%E7%BC%96%E7%A0%81%E5%8A%A9%E6%89%8B/">AI 编码助手</a>,&nbsp;<a href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/">前端开发</a>,&nbsp;<a href="/tags/%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90/">代码生成</a>,&nbsp;<a href="/tags/%E9%87%8D%E6%9E%84/">重构</a>,&nbsp;<a href="/tags/%E5%8D%95%E6%B5%8B/">单测</a></div></div>
</article><ul class="pagination"><li class="page-item ">
                    <span class="page-link">
                        <a href="/">1</a>
                    </span>
                </li><li class="page-item ">
                    <span class="page-link">
                        <a href="/page/2/">2</a>
                    </span>
                </li><li class="page-item ">
                    <span class="page-link">
                        <a href="/page/3/">3</a>
                    </span>
                </li><li class="page-item active">
                    <span class="page-link">
                        <a href="/page/4/">4</a>
                    </span>
                </li><li class="page-item ">
                    <span class="page-link">
                        <a href="/page/5/">5</a>
                    </span>
                </li><li class="page-item ">
                    <span class="page-link">
                        <a href="/page/6/">6</a>
                    </span>
                </li><li class="page-item ">
                    <span class="page-link" aria-hidden="true">&hellip;</span>
                </li><li class="page-item ">
                    <span class="page-link">
                        <a href="/page/8/">8</a>
                    </span>
                </li></ul></div></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.152.2">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.3.0"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">wuwj</a></span>&nbsp;|&nbsp;<span class="license">CC BY-NC 4.0</span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.zh.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/typeit/index.umd.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":50},"data":{"id-1":"A quiet place to keep a record of things."},"search":{"highlightTag":"em","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":30},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
