<!DOCTYPE html>
<html lang="zh-cn">
    <head>
	<meta name="generator" content="Hugo 0.152.2"><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Saiga</title><meta name="Description" content="This is my cool site"><meta property="og:url" content="http://localhost:1313/">
  <meta property="og:site_name" content="Saiga">
  <meta property="og:title" content="Saiga">
  <meta property="og:description" content="This is my cool site">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="website">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Saiga">
  <meta name="twitter:description" content="This is my cool site">
      <meta name="twitter:site" content="@https://github.com/cs11b137">
<meta name="application-name" content="Saiga">
<meta name="apple-mobile-web-app-title" content="Saiga"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/logo.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://localhost:1313/" /><link rel="alternate" href="/index.xml" type="application/rss+xml" title="Saiga">
    <link rel="feed" href="/index.xml" type="application/rss+xml" title="Saiga"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "WebSite",
        "url": "http:\/\/localhost:1313\/","inLanguage": "zh-cn","author": {
                "@type": "Person",
                "name": "wuwj"
            },"description": "This is my cool site","name": "Saiga"
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Saiga">Saiga</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/about/"> About </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Saiga">Saiga</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/about/" title="">About</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="page home" data-home="posts"><div class="home-profile"><div class="home-avatar"><a href="/posts/" title="Posts"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./avatar.svg"
        data-srcset="./avatar.svg, ./avatar.svg 1.5x, ./avatar.svg 2x"
        data-sizes="auto"
        alt="./avatar.svg"
        title="./avatar.svg" /></a></div><div class="home-subtitle"><div id="id-1" class="typeit"></div></div><div class="links"><a href="https://github.com/https://github.com/cs11b137" title="GitHub" target="_blank" rel="noopener noreffer me"><i class="fab fa-github fa-fw" aria-hidden="true"></i></a><a href="https://facebook.com/https://github.com/cs11b137" title="facebook" target="_blank" rel="noopener noreffer me"><i class="fab fa-facebook fa-fw" aria-hidden="true"></i></a><a href="mailto:https://github.com/cs11b137" title="Email" rel="me"><i class="far fa-envelope fa-fw" aria-hidden="true"></i></a><a href="https://github.com/cs11b137" target="_blank" rel="noopener noreffer me"></a><a href="https://linkedin.com/in/https://github.com/cs11b137" title="LinkedIn" target="_blank" rel="noopener noreffer me"><i class="fab fa-linkedin fa-fw" aria-hidden="true"></i></a><a href="https://twitter.com/https://github.com/cs11b137" title="Twitter" target="_blank" rel="noopener noreffer me"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="https://www.instagram.com/https://github.com/cs11b137" title="Instagram" target="_blank" rel="noopener noreffer me"><i class="fab fa-instagram fa-fw" aria-hidden="true"></i></a><a href="https://t.me/https://github.com/cs11b137" title="Telegram" target="_blank" rel="noopener noreffer me"><i class="fab fa-telegram-plane fa-fw" aria-hidden="true"></i></a><a href="https://www.youtube.com/user/https://github.com/cs11b137" title="YouTube" target="_blank" rel="noopener noreffer me"><i class="fab fa-youtube fa-fw" aria-hidden="true"></i></a><a href="/index.xml" title="RSS" target="_blank" rel="noopener noreffer me"><i class="fas fa-rss fa-fw" aria-hidden="true"></i></a></div></div>
<article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/posts/2022-10-30-ai-doc-assistant-v1/">用大模型做一个简单「文档问答助手」</a>
    </h1><div class="post-meta"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>wuwj</a></span>&nbsp;<span class="post-publish">发布于 <time datetime="2022-10-30">2022-10-30</time></span>&nbsp;<span class="post-category">收录于 <a href="/categories/ai-%E6%8E%A2%E7%B4%A2/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>AI 探索</a></span></div><div class="content"><p>2022 年开始，大模型 API 越来越好用，大家最直觉的一个想法就是：</p>
<blockquote>
<p>能不能把项目文档「喂给」模型，然后直接用自然语言问问题？</p>
</blockquote>
<p>这篇文章记录的是一个从 0 到 1 的小 Demo：<strong>用大模型 API + 向量检索，实现一个能回答「我们自己文档」问题的小助手。</strong></p>
<hr>
<h2 id="1-目标和约束">1. 目标和约束</h2>
<p>目标很简单：</p>
<ul>
<li>把部分项目文档（接口说明、架构设计、规范）导入系统；</li>
<li>在一个聊天界面里，可以问：
<ul>
<li>「用户登录接口的必填参数有哪些？」</li>
<li>「私募投资人小程序的技术栈是什么？」</li>
</ul>
</li>
<li>助手能基于文档给出相对准确的回答。</li>
</ul>
<p>约束：</p>
<ul>
<li>不追求「完美答案」；</li>
<li>优先做到：<strong>能指向正确文档，并给出简洁总结</strong>。</li>
</ul>
<hr>
<h2 id="2-总体架构">2. 总体架构</h2>
<p>整体流程可以概括成：</p>
<ol>
<li>文档导入 &amp; 切分；</li>
<li>向量化（Embedding）并存入向量库；</li>
<li>用户提问 → 向量检索相关片段；</li>
<li>把相关片段 + 问题一起发给大模型 → 生成回答；</li>
<li>前端展示答案 + 引用片段。</li>
</ol>
<p>用一张简图就是所谓的：<strong>RAG（检索增强生成）</strong>。</p>
<hr>
<h2 id="3-文档预处理从-markdown-到小段文本">3. 文档预处理：从 Markdown 到「小段文本」</h2>
<p>我们选用的文档源主要是：</p>
<ul>
<li>Git 仓库里的 Markdown（README、设计文档）；</li>
<li>部分导出的接口文档（JSON/YAML 转文本）。</li>
</ul>
<p>预处理步骤：</p>
<ol>
<li>把 Markdown 转成纯文本（保留标题层级）；</li>
<li>按一定策略切分成「小段文本」，比如每段 300–500 字；</li>
<li>每段附带元信息：文档名、段落标题、在文档中的位置。</li>
</ol>
<p>简单示例：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;docId&#34;</span>: <span style="color:#e6db74">&#34;fund-investor-miniapp&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;title&#34;</span>: <span style="color:#e6db74">&#34;技术栈与整体架构&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;content&#34;</span>: <span style="color:#e6db74">&#34;前端采用 Vue3 + uni-app...&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;section&#34;</span>: <span style="color:#e6db74">&#34;2.1 技术栈&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;index&#34;</span>: <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>切分策略的小经验：</p></div><div class="post-footer">
        <a href="/posts/2022-10-30-ai-doc-assistant-v1/">阅读全文</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/%E5%A4%A7%E6%A8%A1%E5%9E%8B/">大模型</a>,&nbsp;<a href="/tags/%E6%96%87%E6%A1%A3%E9%97%AE%E7%AD%94/">文档问答</a>,&nbsp;<a href="/tags/%E5%90%91%E9%87%8F%E6%A3%80%E7%B4%A2/">向量检索</a>,&nbsp;<a href="/tags/%E7%9F%A5%E8%AF%86%E5%BA%93/">知识库</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/posts/2022-09-05-monitoring-and-alert/">前端监控闭环：采集、告警到问题跟踪</a>
    </h1><div class="post-meta"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>wuwj</a></span>&nbsp;<span class="post-publish">发布于 <time datetime="2022-09-05">2022-09-05</time></span>&nbsp;<span class="post-category">收录于 <a href="/categories/%E7%9B%91%E6%8E%A7%E4%B8%8E%E8%BF%90%E7%BB%B4/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>监控与运维</a></span></div><div class="content"><p>很多团队做前端监控的姿势是：</p>
<blockquote>
<p>先接一个 SDK，看到了几个报错，然后就没然后了。</p>
</blockquote>
<p>最后变成：</p>
<ul>
<li>告警群天天响，大家学会了「静音」；</li>
<li>仪表盘很酷，但没人看；</li>
<li>真出大问题时，还是靠用户截图。</li>
</ul>
<p>这篇文章想聊的是：<strong>怎么从「有监控」升级到「有闭环」</strong>：采集、告警、问题跟踪、复盘一条链路打通。</p>
<hr>
<h2 id="1-前端到底要监什么">1. 前端到底要监什么？</h2>
<p>可以按三个维度来想：</p>
<ol>
<li>
<p><strong>可用性</strong></p>
<ul>
<li>JS 运行错误（Error、Promise 未捕获）；</li>
<li>资源加载失败（JS/CSS/图片）；</li>
<li>页面白屏/异常重定向。</li>
</ul>
</li>
<li>
<p><strong>性能</strong></p>
<ul>
<li>首屏指标（FCP/FP/TTI 等的近似值）；</li>
<li>接口耗时、失败率；</li>
<li>静态资源加载时间。</li>
</ul>
</li>
<li>
<p><strong>行为 &amp; 转化</strong></p>
<ul>
<li>关键路径的曝光/点击/完成；</li>
<li>异常行为（频繁刷新、某步流失明显）。</li>
</ul>
</li>
</ol>
<p>实践上，可以先从：<strong>错误 + 性能 + 关键链路打点</strong> 三件事做起。</p>
<hr>
<h2 id="2-采集埋点--sdk-一起用">2. 采集：埋点 &amp; SDK 一起用</h2>
<h3 id="21-错误采集">2.1 错误采集</h3>
<p>典型方式：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span>window.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;error&#39;</span>, (<span style="color:#a6e22e">event</span>) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">reportError</span>({
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;error&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">message</span>: <span style="color:#66d9ef">event.message</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">filename</span>: <span style="color:#66d9ef">event.filename</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">lineno</span>: <span style="color:#66d9ef">event.lineno</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">colno</span>: <span style="color:#66d9ef">event.colno</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">stack</span>: <span style="color:#66d9ef">event.error?.stack</span>,
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>window.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;unhandledrejection&#39;</span>, (<span style="color:#a6e22e">event</span>) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">reportError</span>({
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;unhandledrejection&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">reason</span>: <span style="color:#66d9ef">String</span>(<span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">reason</span>),
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>结合 sourcemap 上传，可以把错误还原到源代码行。</p>
<h3 id="22-性能采集">2.2 性能采集</h3>
<p>利用 Performance API：</p></div><div class="post-footer">
        <a href="/posts/2022-09-05-monitoring-and-alert/">阅读全文</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/%E5%89%8D%E7%AB%AF%E7%9B%91%E6%8E%A7/">前端监控</a>,&nbsp;<a href="/tags/%E5%9F%8B%E7%82%B9/">埋点</a>,&nbsp;<a href="/tags/%E5%91%8A%E8%AD%A6/">告警</a>,&nbsp;<a href="/tags/%E9%94%99%E8%AF%AF%E8%B7%9F%E8%B8%AA/">错误跟踪</a>,&nbsp;<a href="/tags/%E6%80%A7%E8%83%BD/">性能</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/posts/2022-07-14-performance-optimization-case/">一次性能优化实战：从 5s 到 1.5s 的页面加载</a>
    </h1><div class="post-meta"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>wuwj</a></span>&nbsp;<span class="post-publish">发布于 <time datetime="2022-07-14">2022-07-14</time></span>&nbsp;<span class="post-category">收录于 <a href="/categories/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>性能优化</a></span></div><div class="content"><p>有一次线上迭代后，陆续收到反馈：</p>
<blockquote>
<p>「系统能用，就是打开慢了一截。」<br>
「首页白屏时间变长了。」</p>
</blockquote>
<p>监控一看，某个核心页面的首屏时间从 <strong>约 2s 抬升到了接近 5s</strong>。<br>
这篇文章就是那次性能优化的实战复盘：<strong>我们如何量化问题、定位瓶颈、再一步步把首屏拉回到 1.5s 左右。</strong></p>
<hr>
<h2 id="1-先量化而不是拍脑袋">1. 先量化，而不是拍脑袋</h2>
<p>第一步是搞清楚「慢」在哪：</p>
<ul>
<li>首包下载？</li>
<li>JS 执行？</li>
<li>接口耗时？</li>
<li>还是一堆「非必要逻辑」抢在首屏执行？</li>
</ul>
<p>我们主要用了三种手段：</p>
<ol>
<li><strong>Chrome DevTools Performance</strong> 看关键时序；</li>
<li><strong>Lighthouse</strong> 跑实验室指标；</li>
<li><strong>前端埋点</strong> 看真实用户数据（FMP/TTI 的简化近似）。</li>
</ol>
<p>初步结论：</p>
<ul>
<li>JS 资源总体体积较大，首屏要加载的 JS 超过 1MB（压缩后）；</li>
<li>首屏渲染完成前存在一段较长的 JS 执行（主线程被占用）；</li>
<li>首屏接口本身不是特别慢，但被一些<strong>不必要的请求</strong>夹在中间。</li>
</ul>
<p>目标明确：<strong>瘦 JS、少阻塞、分优先级。</strong></p>
<hr>
<h2 id="2-bundle-拆分让首屏只拿它真需要的">2. Bundle 拆分：让首屏只拿它真需要的</h2>
<h3 id="21-分析构建结果">2.1 分析构建结果</h3>
<p>接入 <code>webpack-bundle-analyzer</code> / Vite 插件之后，很快看到几个「大头」：</p>
<ul>
<li>整个 UI 组件库全量引入；</li>
<li>某些图表库（在其他页面才用）被打进首屏 bundle；</li>
<li>若干工具库重复/未 Tree-shaking。</li>
</ul>
<h3 id="22-做的调整">2.2 做的调整</h3>
<ol>
<li>
<p><strong>组件库改为按需引入</strong></p>
<ul>
<li>把 <code>import ElementUI from 'element-ui'</code> 改成 babel 插件/手动按需；</li>
<li>打包结果里组件库体积明显下降。</li>
</ul>
</li>
<li>
<p><strong>路由级别代码拆分</strong></p></div><div class="post-footer">
        <a href="/posts/2022-07-14-performance-optimization-case/">阅读全文</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/%E6%80%A7%E8%83%BD/">性能</a>,&nbsp;<a href="/tags/%E6%87%92%E5%8A%A0%E8%BD%BD/">懒加载</a>,&nbsp;<a href="/tags/%E4%BB%A3%E7%A0%81%E6%8B%86%E5%88%86/">代码拆分</a>,&nbsp;<a href="/tags/%E7%BC%93%E5%AD%98/">缓存</a>,&nbsp;<a href="/tags/skeleton/">Skeleton</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/posts/2022-05-26-encryption-in-frontend/">前端加解密实践：从「别明文传密码」开始</a>
    </h1><div class="post-meta"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>wuwj</a></span>&nbsp;<span class="post-publish">发布于 <time datetime="2022-05-26">2022-05-26</time></span>&nbsp;<span class="post-category">收录于 <a href="/categories/%E5%AE%89%E5%85%A8%E4%B8%8E%E5%8A%A0%E5%AF%86/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>安全与加密</a></span></div><div class="content"><p>每次提到前端加密，评论区都会有人说：</p>
<blockquote>
<p>有 HTTPS 了，还加什么密？<br>
前端代码都是能看到的，没意义。</p>
</blockquote>
<p>理论上没错，但在金融/政企等场景里，<strong>有些需求不是技术可不可行，而是「要不要多一层安全防护 + 满足合规要求」</strong>。</p>
<p>这篇文章从实战出发，聊聊：</p>
<ul>
<li>常见的前端加密需求；</li>
<li>对称 / 非对称加密如何组合使用；</li>
<li>以及实际落地时的一些坑。</li>
</ul>
<hr>
<h2 id="1-https-已经有了为啥还要前端加密">1. HTTPS 已经有了，为啥还要前端加密？</h2>
<p>先说前提：<strong>HTTPS 必须有</strong>，这是基础。<br>
在这个基础上，某些场景仍然会要求：</p>
<ol>
<li>
<p><strong>防止明文敏感信息出现在抓包里</strong></p>
<ul>
<li>即便是 HTTPS，有些合规要求会明确写「不得以明文形式传输密码等敏感信息」；</li>
<li>抓包截图里看到一串密文，和直接看到手机号/密码，感受是不一样的。</li>
</ul>
</li>
<li>
<p><strong>降低中间层日志泄露风险</strong></p>
<ul>
<li>有时候请求会经过网关、代理、日志系统；</li>
<li>如果这些地方有不规范的日志记录，敏感字段加密可以降低损害。</li>
</ul>
</li>
<li>
<p><strong>和现有后端架构/第三方接口对齐</strong></p>
<ul>
<li>有些历史系统已经约定「密码字段用某种算法加密再传」；</li>
<li>前端需要遵守既有协议。</li>
</ul>
</li>
</ol>
<p>前端加密<strong>不是代替 HTTPS</strong>，而是多一层「<strong>应用层加密</strong>」。</p>
<hr>
<h2 id="2-两个基本工具对称--非对称">2. 两个基本工具：对称 &amp; 非对称</h2>
<p>简单回顾一下：</p>
<ul>
<li><strong>对称加密</strong>（如 AES、SM4）：同一把 key 加密解密；</li>
<li><strong>非对称加密</strong>（如 RSA）：公钥加密，私钥解密（或反之）。</li>
</ul>
<p>特性：</p>
<ul>
<li>对称加密：速度快，适合加密大量数据，但<strong>key 如何安全分发</strong>是问题；</li>
<li>非对称加密：适合做「密钥交换」，但加密大数据性能较差。</li>
</ul>
<p>所以常用组合是：</p>
<blockquote>
<p>前端生成一个随机对称密钥 → 用后端公钥加密这个密钥 → 发给后端 → 后端用私钥解出密钥 → 后续用这个对称密钥加解密数据。</p>
</blockquote>
<p>前端常见实现方式：</p>
<ul>
<li>WebCrypto API；</li>
<li>或成熟的 JS 加密库（CryptoJS / JSEncrypt / 国密相关库等）。</li>
</ul>
<hr>
<h2 id="3-一个典型的前端加密流程">3. 一个典型的前端加密流程</h2>
<p>以「登录密码不可明文传输」为例，设计一个简化流程：</p></div><div class="post-footer">
        <a href="/posts/2022-05-26-encryption-in-frontend/">阅读全文</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A8/">前端安全</a>,&nbsp;<a href="/tags/%E5%8A%A0%E5%AF%86/">加密</a>,&nbsp;<a href="/tags/https/">HTTPS</a>,&nbsp;<a href="/tags/%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/">对称加密</a>,&nbsp;<a href="/tags/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/">非对称加密</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/posts/2022-04-01-e-contract-frontend-architecture/">电子合同前端架构：模版、签章与签署流程</a>
    </h1><div class="post-meta"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>wuwj</a></span>&nbsp;<span class="post-publish">发布于 <time datetime="2022-04-01">2022-04-01</time></span>&nbsp;<span class="post-category">收录于 <a href="/categories/%E9%87%91%E8%9E%8D%E5%89%8D%E7%AB%AF/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>金融前端</a>&nbsp;<a href="/categories/%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>架构设计</a></span></div><div class="content"><p>做电子合同相关的前端，会很快感觉到：</p>
<ul>
<li>这已经不只是「展示一个 PDF」；</li>
<li>还牵扯到模版配置、变量渲染、签章交互、签署流程编排、证据留存等。</li>
</ul>
<p>如果一股脑儿堆在一个项目里，很快就会失控。<br>
这篇文章试着从前端视角，把电子合同拆成几个独立模块，聊聊一套比较清晰的架构思路。</p>
<hr>
<h2 id="1-电子合同前端要解决什么">1. 电子合同前端要解决什么？</h2>
<p>从用户视角看，大概是：</p>
<ol>
<li>看到合同预览（包含自己信息）；</li>
<li>在指定位置签名/盖章/确认；</li>
<li>提交后能下载已签署版本，必要时可验证真伪。</li>
</ol>
<p>从前端视角再拆细一点：</p>
<ul>
<li><strong>模版管理</strong>：合同模版如何配置 &amp; 渲染；</li>
<li><strong>变量填充</strong>：客户姓名、证件号、金额等动态内容；</li>
<li><strong>渲染方式</strong>：HTML 还是 PDF 预览，是否支持高缩放；</li>
<li><strong>签章交互</strong>：点击签署区域、手写签名/用预制印章；</li>
<li><strong>流程编排</strong>：签署顺序、多人会签/联签；</li>
<li><strong>留痕 &amp; 防篡改</strong>：前端如何配合后端做证据链。</li>
</ul>
<p>这些职责千万别写在一个「超级组件」里。</p>
<hr>
<h2 id="2-模块切分四层结构">2. 模块切分：四层结构</h2>
<p>我们落地时，大致划成四层：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>业务流程层  ←  电子合同服务层  ←  渲染 &amp; 交互层  ←  基础组件 &amp; 工具层
</span></span></code></pre></div><h3 id="21-业务流程层具体业务系统">2.1 业务流程层（具体业务系统）</h3>
<p>例如：开户流程、理财签约、风险揭示等业务系统：</p>
<ul>
<li>只关心「在流程某一环节触发合同签署」；</li>
<li>不直接操心合同模版、签章细节；</li>
<li>与电子合同前端交互的接口尽量保持简单。</li>
</ul>
<h3 id="22-电子合同服务层前端-sdk">2.2 电子合同服务层（前端 SDK）</h3>
<p>可以理解成一个前端 SDK：</p>
<ul>
<li>提供统一方法：<code>createContract</code>, <code>previewContract</code>, <code>signContract</code>；</li>
<li>内部负责：请求合同服务接口、拿到模版、变量、签署状态等；</li>
<li>把渲染和交互细节屏蔽在内部。</li>
</ul>
<p>示例：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">openContractSignDialog</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#39;@ecm/sdk&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">await</span> <span style="color:#a6e22e">openContractSignDialog</span>({
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">bizType</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;OPEN_ACCOUNT&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">bizId</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;xxx&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">viewer</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;customer&#39;</span>,
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><h3 id="23-渲染--交互层">2.3 渲染 &amp; 交互层</h3>
<ul>
<li>负责把合同模版 + 变量渲染成可阅读界面；</li>
<li>在指定签署域上挂载交互（点击弹签名板等）；</li>
<li>处理缩放、翻页、跳转签署域等体验细节。</li>
</ul>
<h3 id="24-基础组件--工具层">2.4 基础组件 &amp; 工具层</h3>
<ul>
<li>PDF/HTML 渲染组件；</li>
<li>手写签名板组件；</li>
<li>坐标转换、缩放计算工具；</li>
<li>与后端约定的签署域结构解析等。</li>
</ul>
<hr>
<h2 id="3-合同模版与变量渲染">3. 合同模版与变量渲染</h2>
<h3 id="31-模版形式">3.1 模版形式</h3>
<p>常见两种：</p></div><div class="post-footer">
        <a href="/posts/2022-04-01-e-contract-frontend-architecture/">阅读全文</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/%E7%94%B5%E5%AD%90%E5%90%88%E5%90%8C/">电子合同</a>,&nbsp;<a href="/tags/%E5%89%8D%E7%AB%AF%E6%9E%B6%E6%9E%84/">前端架构</a>,&nbsp;<a href="/tags/%E7%AD%BE%E7%AB%A0/">签章</a>,&nbsp;<a href="/tags/%E6%A8%A1%E7%89%88%E7%AE%A1%E7%90%86/">模版管理</a></div></div>
</article><article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
        <a href="/posts/2022-02-10-fintech-form-design/">金融场景下的表单设计：KYC、合规与用户体验</a>
    </h1><div class="post-meta"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>wuwj</a></span>&nbsp;<span class="post-publish">发布于 <time datetime="2022-02-10">2022-02-10</time></span>&nbsp;<span class="post-category">收录于 <a href="/categories/%E9%87%91%E8%9E%8D%E5%89%8D%E7%AB%AF/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>金融前端</a></span></div><div class="content"><p>金融系统里，表单不是简单的「填一填」：</p>
<ul>
<li>监管要求决定了<strong>字段不能乱删</strong>；</li>
<li>风险提示必须<strong>显眼可见</strong>；</li>
<li>用户又会觉得「怎么要填这么多东西」。</li>
</ul>
<p>这篇文章就结合 KYC（了解你的客户）、适当性评估、风险告知等场景，聊聊：<strong>怎么在合规前提下，把表单做得更好用一点。</strong></p>
<hr>
<h2 id="1-金融表单的几个典型场景">1. 金融表单的几个典型场景</h2>
<p>做表单之前，先搞清楚自己处在哪种场景：</p>
<ol>
<li>
<p><strong>开户 / 注册 / KYC 信息收集</strong></p>
<ul>
<li>个人基本信息：姓名、证件号、联系方式；</li>
<li>职业、收入、资产情况；</li>
<li>投资经验、风险偏好。</li>
</ul>
</li>
<li>
<p><strong>风险测评 / 适当性评估</strong></p>
<ul>
<li>一系列问题，用来判断风险承受能力；</li>
<li>结果可能影响可购买的产品范围。</li>
</ul>
</li>
<li>
<p><strong>交易与合规确认</strong></p>
<ul>
<li>下单前的风险提示、产品说明确认；</li>
<li>特定产品的「特别风险揭示」签署。</li>
</ul>
</li>
</ol>
<p>不同场景对「必须完整性」和「交互体验」的要求不一样：</p>
<ul>
<li>KYC 可适度拆步、引导填写；</li>
<li>合同签署类表单则更偏重「留痕」和「不可抵赖」。</li>
</ul>
<hr>
<h2 id="2-必填项不是越多越好">2. 必填项：不是越多越好</h2>
<p>很多产品一开始会把<strong>所有字段都设成必填</strong>，但这会直接劝退用户。更好的做法是：</p>
<h3 id="21-先按监管视角划分优先级">2.1 先按「监管视角」划分优先级</h3>
<p>和合规/风控同事一起，把字段分成：</p>
<ul>
<li><strong>必须采集且必须实时验证</strong>：证件号、姓名、手机号等；</li>
<li><strong>必须采集但可以允许暂时空缺</strong>：部分补充信息，可后续完善；</li>
<li><strong>在特定场景才需要</strong>：例如某类产品才需要额外问卷。</li>
</ul>
<p>前端层面可以做成：</p>
<ul>
<li>第一屏只出现「强必要」字段；</li>
<li>其他放在下一步或「更多信息」里；</li>
<li>支持后续在「个人资料中心」补充。</li>
</ul>
<h3 id="22-必填的表现方式">2.2 必填的表现方式</h3>
<ul>
<li>避免整页红星；</li>
<li>推荐：只在真正必填字段左侧加 <code>*</code>，并在表头写明「* 为必填项」；</li>
<li>错误提示尽量贴近输入框，不要统一在顶部「打一行大红字」。</li>
</ul>
<hr>
<h2 id="3-风险提示要显眼但不要吓跑人">3. 风险提示：要显眼，但不要吓跑人</h2>
<p>金融表单里经常会出现这样的文案：</p>
<blockquote>
<p>本产品不保证本金安全，投资需谨慎…</p>
</blockquote>
<p>以及 N 行法律条款。合规角度看，<strong>展示到位、记录留痕</strong> 很重要；体验上，我们可以这么做：</p>
<h3 id="31-分层展示">3.1 分层展示</h3>
<ul>
<li>对用户最关键的信息（是否保本、可能损失哪些）<strong>用列表或高亮</strong>单独提炼；</li>
<li>详细条款用折叠面板展示，并提供「展开查看全部」。</li>
</ul>
<h3 id="32-交互确认留痕">3.2 交互确认留痕</h3>
<ul>
<li>针对关键提示，使用显式勾选：<code>[ ] 我已阅读并理解上述风险提示</code>；</li>
<li>在后端记录勾选时间、IP、终端信息，方便事后追溯；</li>
<li>不要用自动勾选的复选框，尽量让用户有一次主动操作。</li>
</ul>
<h3 id="33-避免滚动到底才能勾选式折磨">3.3 避免「滚动到底才能勾选」式折磨</h3>
<p>不少系统会要求用户必须拖动滚动条到底才能点击「我已阅读」。如果监管没有硬性要求，建议尽量避免，或控制文本长度，减少用户厌烦情绪。</p></div><div class="post-footer">
        <a href="/posts/2022-02-10-fintech-form-design/">阅读全文</a><div class="post-tags">
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/kyc/">KYC</a>,&nbsp;<a href="/tags/%E8%A1%A8%E5%8D%95%E8%AE%BE%E8%AE%A1/">表单设计</a>,&nbsp;<a href="/tags/%E5%90%88%E8%A7%84/">合规</a>,&nbsp;<a href="/tags/%E7%94%A8%E6%88%B7%E4%BD%93%E9%AA%8C/">用户体验</a></div></div>
</article><ul class="pagination"><li class="page-item ">
                    <span class="page-link">
                        <a href="/">1</a>
                    </span>
                </li><li class="page-item ">
                    <span class="page-link" aria-hidden="true">&hellip;</span>
                </li><li class="page-item ">
                    <span class="page-link">
                        <a href="/page/3/">3</a>
                    </span>
                </li><li class="page-item ">
                    <span class="page-link">
                        <a href="/page/4/">4</a>
                    </span>
                </li><li class="page-item active">
                    <span class="page-link">
                        <a href="/page/5/">5</a>
                    </span>
                </li><li class="page-item ">
                    <span class="page-link">
                        <a href="/page/6/">6</a>
                    </span>
                </li><li class="page-item ">
                    <span class="page-link">
                        <a href="/page/7/">7</a>
                    </span>
                </li><li class="page-item ">
                    <span class="page-link">
                        <a href="/page/8/">8</a>
                    </span>
                </li></ul></div></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.152.2">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.3.0"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">wuwj</a></span>&nbsp;|&nbsp;<span class="license">CC BY-NC 4.0</span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.zh.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/typeit/index.umd.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":50},"data":{"id-1":"A quiet place to keep a record of things."},"search":{"highlightTag":"em","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":30},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
